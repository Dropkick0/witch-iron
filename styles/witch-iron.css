/* Witch Iron System Styles */

/* ----------------------------------------- */
/*  General Styles                           */
/* ----------------------------------------- */

:root {
  --color-primary: #4b3621;
  --color-secondary: #76543a;
  --color-tertiary: #d1b48c;
  --color-accent: #7b2d26;
  --color-highlight: #e6c9a3;
  --color-background: #f5f5dc;
  --color-text: #2d2013;
  --color-text-dark: #333;
  --color-text-muted: #666;
  --color-border: #8a6642;
  --color-border-light: #ccc;
  --color-border-lighter: #ddd;
  --color-border-dark: #444;
  --color-surface-light: #f5e8d2;
  --color-shadow: rgba(0, 0, 0, 0.2);
  --color-success: #006400;
  --color-error: #8b0000;
  --witchiron-bg: #f5f3e6;
  --witchiron-border: #a39388;
  --witchiron-font: serif;
  --witchiron-header-bg: #a39388;
  --witchiron-header-text: white;
  --witchiron-text-accent: var(--color-accent);
  --witchiron-success: green;
  --witchiron-danger: var(--color-accent);
  --witchiron-warning: orange;
  --witchiron-panel-bg: #e5e2d5;
  --witchiron-text: #444;
  --witchiron-text-muted: #777;
  --witchiron-dice: var(--color-accent);
  --witchiron-button-bg: #a39388;
  --witchiron-button-text: white;
  --witchiron-button-hover: #857971;
  --witchiron-button-secondary-bg: #e5e2d5;
  --witchiron-button-secondary-text: #444;
  --witchiron-button-secondary-hover: #d5d2c5;
  --witchiron-warning-bg: #fff3cd;
  --witchiron-warning-text: #856404;
  --witchiron-danger-bg: #f8d7da;
  --witchiron-danger-text: #721c24;
}

.witch-iron {
  --sheet-width: 720px;
  --sheet-height: 800px;
  --primary-color: var(--color-primary);
  --secondary-color: var(--color-secondary);
  --tertiary-color: var(--color-tertiary);
  --accent-color: #a47449;
  --background-color: var(--color-background);
  --text-color: var(--color-text);
  --border-color: var(--color-border);
  --highlight-color: var(--color-highlight);
  --shadow-color: var(--color-shadow);
  --error-color: var(--color-error);
  --success-color: var(--color-success);
  --header-height: 130px;  /* Approximate header height */
  --tabs-height: 35px;     /* Approximate tabs height */
}

.witch-iron.sheet {
  min-width: var(--sheet-width);
  min-height: var(--sheet-height);
  max-width: 100%;
  max-height: 100%;
}

.witch-iron.sheet.descendant {
  background: var(--background-color);
  color: var(--text-color);
  font-family: 'Gentium Book', serif;
}

/* Sheet Header */
.witch-iron.sheet.descendant .sheet-header {
  flex: 0 0 var(--header-height);
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-bottom: 0;
  border-bottom: 2px solid var(--border-color);
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 100%);
}

.witch-iron.sheet.descendant .sheet-header img {
  flex: 0 0 100px;
  height: 100px;
  margin-right: 10px;
  border: 2px solid var(--border-color);
  border-radius: 5px;
  object-fit: cover;
}

.witch-iron.sheet.descendant .sheet-header .header-fields {
  flex: 1;
}

.witch-iron.sheet.descendant h1.charname {
  height: 40px;
  margin: 0;
  padding: 0;
  border-bottom: 1px solid var(--border-color);
}

.witch-iron.sheet.descendant h1.charname input {
  width: 100%;
  height: 100%;
  margin: 0;
  font-size: 1.8em;
  font-weight: bold;
  font-family: 'Gentium Book', serif;
  color: var(--primary-color);
  border: none;
  background: transparent;
}

.witch-iron.sheet.descendant .header-details {
  margin-top: 5px;
}

.witch-iron.sheet.descendant .header-details .tier-info {
  flex: 1;
  display: flex;
  align-items: center;
  flex-wrap: wrap;
}

.witch-iron.sheet.descendant .header-details label {
  font-weight: bold;
  margin-right: 5px;
  margin-bottom: 5px;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .header-details input {
  width: 60px;
  margin-right: 15px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  text-align: center;
}

.witch-iron.sheet.descendant .tier {
  display: flex;
  align-items: center;
}

.witch-iron.sheet.descendant .tier-value {
  font-size: 1.2em;
  font-weight: bold;
  padding: 2px 8px;
  background: var(--accent-color);
  color: white;
  border-radius: 3px;
}

/* Sheet Tabs */
.witch-iron.sheet.descendant .sheet-tabs {
  flex: 0 0 var(--tabs-height);
  margin-bottom: 0;
  border-bottom: 1px solid var(--border-color);
}

.witch-iron.sheet.descendant .sheet-tabs .item {
  font-weight: bold;
  border-radius: 5px 5px 0 0;
  margin: 0 5px 0 0;
  padding: 5px 10px;
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 70%);
  border: 1px solid var(--border-color);
  border-bottom: none;
}

.witch-iron.sheet.descendant .sheet-tabs .item.active {
  background: var(--background-color);
  border-bottom: 1px solid var(--background-color);
  margin-bottom: -1px;
}

/* Sheet Content Layout */
.witch-iron.sheet.descendant .sheet-content {
  display: flex;
  height: calc(100% - var(--header-height) - var(--tabs-height));
  border-top: 1px solid var(--border-color);
}

.witch-iron.sheet.descendant .sheet-body {
  flex: 1;
  height: 100%;
  overflow-y: auto;
  border-top: none; /* Remove since we moved border to the .sheet-content */
}

/* Sidebar with Attribute Circles */
.witch-iron.sheet.descendant .attributes-sidebar {
  flex: 0 0 100px;
  padding: 10px 10px 0 10px;
  overflow-y: auto;
  background-color: var(--background-color);
  border-right: 1px solid var(--border-color);
  box-shadow: inset -2px 0 5px var(--shadow-color);
  height: 100%; /* Ensure the sidebar takes full height */
  display: flex;
  flex-direction: column;
}

.witch-iron.sheet.descendant .attribute-circles {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  margin-top: 10px;
  height: 100%;
  justify-content: flex-start;
}

.witch-iron.sheet.descendant .attribute-circle {
  position: relative;
  width: 85px;
  height: 85px;
  border-radius: 50%;
  background: var(--tertiary-color);
  border: 2px solid var(--border-color);
  box-shadow: 0 2px 4px var(--shadow-color);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 0;
  cursor: pointer;
  transition: all 0.2s ease;
}

.witch-iron.sheet.descendant .attribute-edit {
  position: absolute;
  width: 24px;
  height: 24px;
  top: -8px;
  left: -8px;
  background: var(--primary-color);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  box-shadow: 0 1px 3px var(--shadow-color);
  cursor: pointer;
  z-index: 10;
  transition: all 0.2s ease;
}

.witch-iron.sheet.descendant .attribute-edit:hover {
  background: var(--accent-color);
  transform: scale(1.1);
}

.witch-iron.sheet.descendant .attribute-circle input {
  position: absolute;
  width: 40px;
  height: 30px;
  opacity: 0;
  pointer-events: none;
}

.witch-iron.sheet.descendant .attribute-value {
  font-size: 1.8em;
  font-weight: bold;
  color: var(--primary-color);
  position: relative;
  top: -15px; /* Move up more to make room for full name */
}

.witch-iron.sheet.descendant .attribute-label {
  position: absolute;
  bottom: 27px; /* Position above the bonus */
  font-weight: bold;
  font-size: 1em; /* Smaller font for full name */
  color: var(--primary-color);
  text-align: center;
  width: 100%;
}

.witch-iron.sheet.descendant .attribute-bonus {
  position: absolute;
  bottom: 12px; /* Position below the label */
  width: 45%;
  text-align: center;
  font-weight: bold;
  font-size: 0.7em; /* Slightly smaller for bonus */
  color: var(--primary-color);
  background-color: rgba(255, 255, 255, 0.6);
  padding: 2px 0; /* Adjust padding */
  border-radius: 2px; /* Add a slight border radius */
}

.witch-iron.sheet.descendant .roll-attribute {
  display: none; /* Hide the roll button as we're making the whole circle clickable for rolling */
}

/* Tab Content Styling */
.witch-iron.sheet.descendant .tab {
  padding: 15px;
  height: 100%;
}

.witch-iron.sheet.descendant .attributes-container {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.witch-iron.sheet.descendant .attributes-content {
  padding: 5px 10px;
}

/* Resources Section */
.witch-iron.sheet.descendant .resources-section,
.witch-iron.sheet.descendant .derived-section {
  margin-bottom: 20px;
  padding: 10px;
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid var(--border-color);
  border-radius: 5px;
}

.witch-iron.sheet.descendant h2 {
  border-bottom: 1px solid var(--border-color);
  font-size: 1.2em;
  color: var(--primary-color);
  margin: 0 0 10px 0;
  padding-bottom: 5px;
}

.witch-iron.sheet.descendant .resource,
.witch-iron.sheet.descendant .derived-stat,
.witch-iron.sheet.descendant .resource-choice {
  align-items: center;
  margin-bottom: 5px;
}

.witch-iron.sheet.descendant .resource label,
.witch-iron.sheet.descendant .derived-stat label,
.witch-iron.sheet.descendant .resource-choice label {
  flex: 0 0 100px;
  font-weight: bold;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .resource input,
.witch-iron.sheet.descendant .derived-stat input {
  width: 60px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  text-align: center;
}

.witch-iron.sheet.descendant .resource-max {
  margin-left: 5px;
  color: var(--primary-color);
  font-weight: bold;
}

.witch-iron.sheet.descendant .derived-stat span {
  font-weight: bold;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .resource-choice select {
  flex: 1;
  height: 24px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
}

/* Grid Layouts */
.witch-iron.sheet.descendant .grid {
  display: grid;
  gap: 5px;
}

.witch-iron.sheet.descendant .grid-2col {
  grid-template-columns: repeat(2, minmax(0, 1fr));
}

/* Flexbox Utilities */
.witch-iron.sheet.descendant .flexrow {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
}

.witch-iron.sheet.descendant .flexcol {
  display: flex;
  flex-direction: column;
}

/* Skills Tab */
.witch-iron.sheet.descendant .skills-container {
  margin-left: 0px;
  width: calc(100% - 0px);
}

.witch-iron.sheet.descendant .skills-list {
  padding: 5px;
}

.witch-iron.sheet.descendant .skill-categories {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.witch-iron.sheet.descendant .skill-attribute-group {
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 5px;
  padding: 8px;
  margin-bottom: 8px;
  background: rgba(255, 255, 255, 0.3);
}

.witch-iron.sheet.descendant .skill-attribute-group h3 {
  color: var(--primary-color);
  font-size: 1em;
  margin-top: 0;
  margin-bottom: 5px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 3px;
}

.witch-iron.sheet.descendant .skill-item {
  display: flex;
  align-items: center;
  padding: 5px;
  margin-bottom: 5px;
  border-bottom: 1px solid rgba(0,0,0,0.1);
}

.witch-iron.sheet.descendant .skill-name {
  flex: 3;
  font-weight: 500;
  cursor: pointer;
  color: var(--color-text-hyperlink, #4b6dc5);
  position: relative;
}

.witch-iron.sheet.descendant .skill-name:hover {
  text-decoration: underline;
}

.witch-iron.sheet.descendant .skill-name::after {
  display: none;
}

.witch-iron.sheet.descendant .skill-ability {
  flex: 2;
  color: #777;
  font-size: 0.9em;
  font-style: italic;
}

.witch-iron.sheet.descendant .skill-item input {
  flex: 1;
  min-width: 50px;
  max-width: 60px;
  height: 24px;
  margin: 0 5px;
}

.witch-iron.sheet.descendant .skill-item button {
  flex: 0 0 30px;
  height: 24px;
  margin-left: 5px;
  padding: 0;
  background: #eee;
  border: 1px solid var(--color-border-light);
  border-radius: 3px;
}

.witch-iron.sheet.descendant .skill-item button:hover {
  background: var(--color-border-lighter);
}

/* Ensure skills tab has scrolling for potentially long content */
.witch-iron.sheet.descendant .tab.skills {
  overflow-y: auto;
  max-height: 100%;
  padding-right: 5px;
}

/* Equipment Tab */
.witch-iron.sheet.descendant .equipment-container {
  height: 100%;
  overflow-y: auto;
}

.witch-iron.sheet.descendant .inventory-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.witch-iron.sheet.descendant .inventory-section {
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid var(--border-color);
  border-radius: 5px;
  padding: 10px;
}

.witch-iron.sheet.descendant .inventory-section h2 {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.witch-iron.sheet.descendant .inventory-section h2 button {
  width: 24px;
  height: 24px;
  padding: 0;
  line-height: 1;
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: 3px;
}

.witch-iron.sheet.descendant .inventory-section h2 button:hover {
  background: var(--accent-color);
}

.witch-iron.sheet.descendant .inventory-header {
  border-bottom: 1px solid var(--border-color);
  font-weight: bold;
  padding: 5px;
  margin-bottom: 5px;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .items-list {
  display: flex;
  flex-direction: column;
  gap: 3px;
}

.witch-iron.sheet.descendant .item {
  align-items: center;
  padding: 5px;
  border-radius: 3px;
  background: rgba(255, 255, 255, 0.2);
}

.witch-iron.sheet.descendant .item:hover {
  background: rgba(255, 255, 255, 0.4);
}

.witch-iron.sheet.descendant .item-name {
  flex: 1;
  padding-left: 5px;
}

.witch-iron.sheet.descendant .item-damage,
.witch-iron.sheet.descendant .item-defense,
.witch-iron.sheet.descendant .item-qty {
  flex: 0 0 80px;
  text-align: center;
}

.witch-iron.sheet.descendant .item-weight {
  flex: 0 0 60px;
  text-align: center;
}

.witch-iron.sheet.descendant .item-controls {
  flex: 0 0 60px;
  text-align: right;
}

.witch-iron.sheet.descendant .item-controls a {
  margin-left: 5px;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .item-controls a:hover {
  color: var(--accent-color);
  text-shadow: 0 0 5px var(--shadow-color);
}

/* Character Tab */
.witch-iron.sheet.descendant .character-container {
  height: 100%;
  overflow-y: auto;
}

.witch-iron.sheet.descendant .character-details {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.witch-iron.sheet.descendant .bio-section,
.witch-iron.sheet.descendant .background-section {
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid var(--border-color);
  border-radius: 5px;
  padding: 10px;
}

.witch-iron.sheet.descendant .form-group {
  margin-bottom: 10px;
}

.witch-iron.sheet.descendant .form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 3px;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .form-group input {
  width: 100%;
  padding: 5px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
}

.witch-iron.sheet.descendant .form-group textarea {
  width: 100%;
  padding: 5px;
  height: 80px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  font-family: inherit;
  resize: vertical;
}

/* Notes Tab */
.witch-iron.sheet.descendant .notes-container {
  height: 100%;
  overflow-y: auto;
}

.witch-iron.sheet.descendant .notes-area {
  background: rgba(255, 255, 255, 0.3);
  border: 1px solid var(--border-color);
  border-radius: 5px;
  padding: 10px;
  height: calc(100% - 20px);
}

.witch-iron.sheet.descendant .notes-area textarea {
  width: 100%;
  height: calc(100% - 40px);
  padding: 5px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  font-family: inherit;
  resize: none;
}

/* ----------------------------------------- */
/*  Actor Sheet Styles                       */
/* ----------------------------------------- */

/* Specific styles for descendant sheets */
.witch-iron.sheet.descendant .attribute-section {
  margin-bottom: 15px;
}

.witch-iron.sheet.descendant .attribute {
  margin-bottom: 5px;
  padding: 3px;
  border-bottom: 1px solid var(--color-shadow);
}

.witch-iron.sheet.descendant .attribute-bonus {
  margin-left: auto;
  padding: 0 5px;
  font-weight: bold;
  color: var(--color-primary);
}

.witch-iron.sheet.descendant .resource {
  margin-bottom: 10px;
  padding: 5px;
  background: rgba(0, 0, 0, 0.03);
  border-radius: 3px;
}

.witch-iron.sheet.descendant .resource-max {
  font-size: 0.8em;
  color: var(--color-secondary);
}

.witch-iron.sheet.descendant .skills-table {
  width: 100%;
  border-collapse: collapse;
}

.witch-iron.sheet.descendant .skills-table th {
  text-align: left;
  padding: 5px;
  background: var(--color-primary);
  color: white;
}

.witch-iron.sheet.descendant .skills-table td {
  padding: 3px 5px;
  border-bottom: 1px solid var(--color-shadow);
}

.witch-iron.sheet.descendant .skill-category {
  background: rgba(0, 0, 0, 0.05);
}

.witch-iron.sheet.descendant .skill-roll {
  text-align: center;
}

.witch-iron.sheet.descendant .items-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.witch-iron.sheet.descendant .items-header {
  font-weight: bold;
  border-bottom: 2px solid var(--color-border);
  padding: 5px 0;
}

.witch-iron.sheet.descendant .item {
  padding: 3px 0;
  border-bottom: 1px solid var(--color-shadow);
}

.witch-iron.sheet.descendant .item-controls {
  text-align: right;
}

/* Specific styles for monster sheets */
.witch-iron.sheet.monster .monster-stats {
  padding: 5px;
  background: rgba(0, 0, 0, 0.03);
  border-radius: 3px;
  margin-bottom: 10px;
}

.witch-iron.sheet.monster .derived-stat {
  padding: 3px 5px;
  border-bottom: 1px solid var(--color-shadow);
}

.witch-iron.sheet.monster .mob-section {
  padding: 5px;
  background: rgba(0, 0, 0, 0.03);
  border-radius: 3px;
}

/* ----------------------------------------- */
/*  Item Sheet Styles                        */
/* ----------------------------------------- */

.witch-iron.sheet.item .form-group {
  margin-bottom: 10px;
}

.witch-iron.sheet.item .form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 3px;
}

.witch-iron.sheet.item .form-group input,
.witch-iron.sheet.item .form-group textarea,
.witch-iron.sheet.item .form-group select {
  width: 100%;
  padding: 5px;
  border: 1px solid var(--color-border);
  border-radius: 3px;
}

.witch-iron.sheet.item .form-group textarea {
  resize: vertical;
}

/* ----------------------------------------- */
/*  Chat Message Styles                      */
/* ----------------------------------------- */

.witch-iron.roll-card {
  padding: 10px;
  background: var(--color-background);
  border: 1px solid var(--color-border);
  border-radius: 5px;
}

.witch-iron.roll-card .card-header {
  border-bottom: 1px solid var(--color-border);
  margin-bottom: 5px;
  padding-bottom: 5px;
}

.witch-iron.roll-card .card-header h3 {
  margin: 0;
  color: var(--color-primary);
}

.witch-iron.roll-card table {
  width: 100%;
  margin: 5px 0;
}

.witch-iron.roll-card td {
  padding: 3px 5px;
}

.witch-iron.roll-card .roll-outcome {
  font-weight: bold;
}

.witch-iron.roll-card .roll-outcome.success {
  color: var(--color-success);
}

.witch-iron.roll-card .roll-outcome.failure {
  color: var(--color-failure);
}

.witch-iron.roll-card .roll-outcome.critical-hit {
  color: var(--color-critical);
}

.witch-iron.roll-card .roll-outcome.fumble {
  color: var(--color-fumble);
}

.witch-iron.roll-card .roll-hits {
  font-weight: bold;
}

.witch-iron.roll-card .roll-hits.positive {
  color: var(--color-success);
}

.witch-iron.roll-card .roll-hits.negative {
  color: var(--color-failure);
}

.witch-iron.roll-card .card-flavor {
  border-top: 1px solid var(--color-border);
  margin-top: 5px;
  padding-top: 5px;
  font-style: italic;
}

/* Hit calculation details */
.witch-iron.roll-card .hit-calculation {
  margin-top: 8px;
  border-top: 1px dotted var(--color-border);
  padding-top: 8px;
}

.witch-iron.roll-card .toggle-hit-details {
  display: inline-block;
  cursor: pointer;
  font-size: 0.9em;
  color: var(--color-primary);
  padding: 2px 5px;
  border-radius: 3px;
  background: rgba(0, 0, 0, 0.05);
}

.witch-iron.roll-card .toggle-hit-details:hover {
  color: var(--color-secondary);
  background: rgba(0, 0, 0, 0.1);
}

.witch-iron.roll-card .hit-details-content {
  margin-top: 5px;
  padding: 5px;
  background: rgba(0, 0, 0, 0.02);
  border-radius: 3px;
  font-size: 0.9em;
}

.witch-iron.roll-card .hit-details-content.hidden {
  display: none;
}

.witch-iron.roll-card .hit-detail-row {
  display: flex;
  justify-content: space-between;
  margin-bottom: 2px;
  padding-bottom: 2px;
  border-bottom: 1px dotted rgba(0, 0, 0, 0.1);
}

.witch-iron.roll-card .hit-detail-row.total {
  margin-top: 5px;
  font-weight: bold;
  border-top: 1px solid var(--color-border);
  padding-top: 5px;
  border-bottom: none;
}

.witch-iron.roll-card .hit-detail-row .hit-detail-label {
  flex: 0 0 60%;
}

.witch-iron.roll-card .hit-detail-row .hit-detail-value {
  flex: 0 0 30%;
  text-align: right;
}

.witch-iron.roll-card .hit-detail-row .hit-detail-value.positive {
  color: var(--color-success);
}

.witch-iron.roll-card .hit-detail-row .hit-detail-value.negative {
  color: var(--color-failure);
}

/* Injury card in chat */
.witch-iron.injury-card {
  padding: 5px;
  border-radius: 3px;
}

.witch-iron.injury-card.severity-1 {
  border-left: 3px solid #c9b458;
}

.witch-iron.injury-card.severity-2 {
  border-left: 3px solid #c97158;
}

.witch-iron.injury-card.severity-3 {
  border-left: 3px solid #c95858;
}

/* ----------------------------------------- */
/*  Utility Classes                          */
/* ----------------------------------------- */

.flexrow {
  display: flex;
  align-items: center;
}

.flexcol {
  display: flex;
  flex-direction: column;
}

.flex-center {
  align-items: center;
  justify-content: center;
}

.flex-between {
  justify-content: space-between;
}

.grid-2col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 5px;
}

.grid-3col {
  display: grid;
  grid-template-columns: 1fr 1fr 1fr;
  gap: 10px;
}

.full-width {
  width: 100%;
}

/* Form field styling */
.form-group {
  margin-bottom: 10px;
}

.form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 3px;
}

.form-group input,
.form-group textarea,
.form-group select {
  width: 100%;
  padding: 5px;
  border: 1px solid var(--color-border);
  border-radius: 3px;
}

/* Button styling */
button {
  background: var(--color-primary);
  color: white;
  border: none;
  border-radius: 3px;
  padding: 5px 10px;
  cursor: pointer;
}

button:hover {
  background: var(--color-secondary);
}

button.roll-skill {
  background: var(--color-secondary);
  padding: 2px 8px;
  font-size: 0.9em;
}

button.roll-skill:hover {
  background: var(--color-primary);
}

/* Actor Sheet - Descendant */
.witch-iron.sheet.descendant {
  position: relative; /* Create positioning context */
}

.witch-iron.sheet.descendant .attributes-section {
  display: flex;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

.witch-iron.sheet.descendant .attribute-item {
  flex: 1 0 30%;
  margin: 5px;
  padding: 5px;
  background: rgba(0, 0, 0, 0.05);
  border-radius: 3px;
  text-align: center;
}

.witch-iron.sheet.descendant .attribute-label {
  font-weight: bold;
}

.witch-iron.sheet.descendant .skills-section {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 5px;
}

.witch-iron.sheet.descendant .skill-item {
  padding: 3px;
  margin-bottom: 2px;
  border-bottom: 1px solid var(--color-border-light);
}

/* Actor Sheet - Monster */
.witch-iron.sheet.monster {
  background: var(--background-color);
  color: var(--text-color);
  font-family: 'Gentium Book', serif;
  --header-height: 110px;
  --tabs-height: 33px;
  min-height: 680px;
}

/* Sheet Header */
.witch-iron.sheet.monster .sheet-header {
  flex: 0 0 var(--header-height);
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-bottom: 0;
  border-bottom: 2px solid var(--border-color);
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 100%);
}

.witch-iron.sheet.monster .sheet-header img {
  flex: 0 0 100px;
  height: 100px;
  margin-right: 10px;
  border: 2px solid var(--border-color);
  border-radius: 5px;
  object-fit: cover;
}

.witch-iron.sheet.monster .sheet-header .header-fields {
  flex: 1;
}

.witch-iron.sheet.monster h1.charname {
  height: 40px;
  margin: 0;
  padding: 0;
  border-bottom: 1px solid var(--border-color);
}

.witch-iron.sheet.monster h1.charname input {
  width: 100%;
  height: 100%;
  margin: 0;
  font-size: 1.8em;
  font-weight: bold;
  font-family: 'Gentium Book', serif;
  color: var(--primary-color);
  border: none;
  background: transparent;
}

/* Sheet Tabs */
.witch-iron.sheet.monster .sheet-tabs {
  height: var(--tabs-height);
  flex: 0 0 var(--tabs-height);
  margin-bottom: 0;
  border-bottom: 1px solid var(--border-color);
}

.witch-iron.sheet.monster .sheet-tabs .item {
  font-weight: bold;
  border-radius: 5px 5px 0 0;
  margin: 0 5px 0 0;
  padding: 5px 10px;
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 70%);
  border: 1px solid var(--border-color);
  border-bottom: none;
}

.witch-iron.sheet.monster .sheet-tabs .item.active {
  background: var(--background-color);
  border-bottom: 1px solid var(--background-color);
  margin-bottom: -1px;
}

/* Sheet Content Layout */
.witch-iron.sheet.monster .sheet-content {
  display: flex;
  flex: 1;
  height: calc(100% - var(--tabs-height));
  overflow: hidden;
  border-top: none;
}

.witch-iron.sheet.monster .sheet-body {
  flex: 1;
  height: 100%;
  overflow-y: auto;
  margin: 0 0 0 5px;
  padding-bottom: 10px;
}

/* Sidebar with Attribute Circles for Monster */
.witch-iron.sheet.monster .attributes-sidebar {
  flex: 0 0 100px;
  padding: 10px 10px 0 10px;
  overflow-y: auto;
  background-color: var(--background-color);
  border-right: 1px solid var(--border-color);
  box-shadow: inset -2px 0 5px var(--shadow-color);
  height: 100%; /* Ensure the sidebar takes full height */
  display: flex;
  flex-direction: column;
}

.witch-iron.sheet.monster .attribute-circles {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 15px;
  margin-top: 10px;
  height: 100%;
  justify-content: flex-start;
}

.witch-iron.sheet.monster .attribute-circle {
  position: relative;
  width: 85px;
  height: 85px;
  border-radius: 50%;
  background: var(--tertiary-color);
  border: 2px solid var(--border-color);
  box-shadow: 0 2px 4px var(--shadow-color);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 0;
  cursor: pointer;
  transition: all 0.2s ease;
}

.witch-iron.sheet.monster .attribute-circle[data-attribute="specialized"],
.witch-iron.sheet.monster .attribute-circle[data-attribute="general"],
.witch-iron.sheet.monster .attribute-circle[data-attribute="inept"],
.witch-iron.sheet.monster .custom-circle[data-attribute="custom1"],
.witch-iron.sheet.monster .custom-circle[data-attribute="custom2"] {
  background: var(--tertiary-color);
  border: 2px solid var(--border-color);
}

.witch-iron.sheet.monster .attribute-value {
  font-size: 1.8em;
  font-weight: bold;
  color: var(--primary-color);
  position: relative;
  top: -15px; /* Move up more to make room for full name */
}

.witch-iron.sheet.monster .attribute-label {
  position: absolute;
  bottom: 27px; /* Position above the bonus */
  font-weight: bold;
  font-size: 1em; /* Smaller font for full name */
  color: var(--primary-color);
  text-align: center;
  width: 100%;
}

.witch-iron.sheet.monster .attribute-bonus {
  position: absolute;
  bottom: 12px; /* Position below the label */
  width: 45%;
  text-align: center;
  font-weight: bold;
  font-size: 0.7em; /* Slightly smaller for bonus */
  color: var(--primary-color);
  background-color: rgba(255, 255, 255, 0.6);
  padding: 2px 0; /* Adjust padding */
  border-radius: 2px; /* Add a slight border radius */
}

.witch-iron.sheet.monster .config-button {
  position: absolute;
  width: 24px;
  height: 24px;
  top: -8px;
  left: -8px;
  background: var(--primary-color);
  color: white;
  border-radius: 50%;
  border: 1px solid var(--border-color);
  box-shadow: 0 1px 3px var(--shadow-color);
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
  z-index: 100;
}

.witch-iron.sheet.monster .config-button:hover {
  background: var(--accent-color);
  transform: scale(1.1);
}

.witch-iron.sheet.monster .attribute-circle:hover {
  transform: scale(1.05);
  box-shadow: 0 0 8px var(--shadow-color);
  border-color: var(--accent-color);
  background: rgba(255, 255, 255, 0.5);
  z-index: 20;
}

.witch-iron.sheet.monster .attribute-circle:active,
.witch-iron.sheet.monster .attribute-circle:focus {
  transform: scale(0.95);
  border-color: var(--accent-color);
  box-shadow: 0 0 12px var(--accent-color);
}

/* Item Sheets */
.witch-iron.sheet.item.injury {
  min-width: 460px;
  min-height: 400px;
}

.witch-iron.sheet .profile-img {
  flex: 0 0 100px;
  height: 100px;
  margin-right: 10px;
  object-fit: contain;
  border: none;
}

.witch-iron.sheet .sheet-header {
  display: flex;
  flex-direction: row;
  align-items: center;
  margin-bottom: 10px;
  padding: 5px;
  border-bottom: 1px solid #AAA;
}

.witch-iron.sheet .header-fields {
  flex: 1;
}

.witch-iron.sheet .header-fields h1 input {
  height: 36px;
  font-size: 1.5em;
  width: 100%;
  margin: 0;
}

/* Form groups and inputs */
.witch-iron.sheet .form-group {
  margin: 5px 0 15px;
}

.witch-iron.sheet .form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 5px;
}

.witch-iron.sheet .form-group select,
.witch-iron.sheet .form-group input,
.witch-iron.sheet .form-group textarea {
  width: 100%;
  padding: 5px;
  border: 1px solid #AAA;
  border-radius: 3px;
}

.witch-iron.sheet .form-group input[type="number"] {
  width: 80px;
}

.witch-iron.sheet .injury-details {
  padding: 0 10px;
}

/* Specific styles for injury severity */
.witch-iron.sheet select[name="system.severity.value"] {
  width: 150px;
}

/* Sheet body scrollable area */
.witch-iron.sheet .sheet-body {
  overflow-y: auto;
  flex: 1;
  padding: 0;
}

/* Responsive design */
@media (max-width: 600px) {
  .witch-iron.sheet.item.injury {
    min-width: 380px;
  }
  
  .witch-iron.sheet .profile-img {
    flex: 0 0 80px;
    height: 80px;
  }
}

/* Add this to your existing CSS after the header-fields section */

.witch-iron.sheet .severity-display {
  font-size: 1.1em;
  margin-top: 5px;
  color: #666;
}

/* Update severity label to be dynamic based on numeric value */
.witch-iron.sheet .severity-label {
  font-weight: bold;
}

/* Replace categorical severity classes with functional CSS using custom variables */
.witch-iron.sheet .injury-severity {
  /* We'll use the severity value directly in the HTML instead of classes */
  font-weight: bold;
  padding: 5px 10px;
  border-radius: 3px;
}

/* Remove categorical severity classes entirely
.witch-iron.sheet .severity-minor {
  color: #3a7a42;
}

.witch-iron.sheet .severity-major {
  color: #b26213;
}

.witch-iron.sheet .severity-severe {
  color: #972727;
}
*/

/* Medical options styling */
.witch-iron.sheet select[name="system.medicalOption"] {
  width: 100%;
  font-size: 0.9em;
}

/* Add a small asterisk indicator for the medical aid option */
.witch-iron.sheet option[value="aid"]::after {
  content: " *";
  color: #3a7a42;
}

/* Add a double-dagger indicator for the surgery option */
.witch-iron.sheet option[value="surgery"]::after {
  content: " â€¡";
  color: #b26213;
}

/* Style for advanced surgery option */
.witch-iron.sheet option[value="advanced"] {
  font-style: italic;
  color: #972727;
}

/* Conditions section styling */
.witch-iron.sheet .conditions-container {
  border: 1px solid var(--color-border);
  border-radius: 5px;
  padding: 10px;
  background: rgba(0, 0, 0, 0.03);
  margin-bottom: 10px;
}

.witch-iron.sheet .condition-selection {
  margin-bottom: 10px;
}

.witch-iron.sheet .condition-rating-container,
.witch-iron.sheet .condition-location-container {
  display: flex;
  align-items: center;
}

.witch-iron.sheet .condition-rating {
  width: 60px !important;
  text-align: center;
}

.witch-iron.sheet select.condition-type {
  margin-right: 10px;
}

.witch-iron.sheet .condition-removal,
.witch-iron.sheet .condition-notes {
  margin-top: 8px;
}

.witch-iron.sheet .condition-removal label,
.witch-iron.sheet .condition-notes label {
  font-size: 0.9em;
  color: var(--color-text);
  margin-bottom: 3px;
}

/* Style for disabled inputs */
.witch-iron.sheet input:disabled, 
.witch-iron.sheet textarea:disabled,
.witch-iron.sheet select:disabled {
  background-color: #f0f0f0;
  color: #888;
  border-color: var(--color-border-light);
}

/* Condition types color-coding */
.witch-iron.sheet option[value="aflame"],
.witch-iron.sheet option[value="bleed"],
.witch-iron.sheet option[value="poison"] {
  color: #8c3130; /* danger conditions */
}

.witch-iron.sheet option[value="blind"],
.witch-iron.sheet option[value="deaf"],
.witch-iron.sheet option[value="pain"] {
  color: #b26213; /* sensory impairment */
}

.witch-iron.sheet option[value="corruption"],
.witch-iron.sheet option[value="stress"] {
  color: #632836; /* mental conditions */
}

.witch-iron.sheet option[value="fatigue"] {
  color: #3a5a6d; /* fatigue */
}

.witch-iron.sheet option[value="entangle"],
.witch-iron.sheet option[value="helpless"],
.witch-iron.sheet option[value="stun"],
.witch-iron.sheet option[value="prone"] {
  color: #4a6d42; /* control conditions */
}

.witch-iron.sheet option[value="trauma"] {
  color: #972727; /* physical trauma */
}

/* Item Sheets */
.witch-iron.sheet.injury .severity-select {
  margin-bottom: 10px;
}

/* Roll styling for chat */
.witch-iron-roll {
  padding: 5px;
  border: 1px solid var(--color-text-muted);
  border-radius: 5px;
  margin-bottom: 5px;
}

.witch-iron-roll .roll-header {
  font-weight: bold;
  border-bottom: 1px solid var(--color-border-lighter);
  margin-bottom: 5px;
  padding-bottom: 3px;
}

.witch-iron-roll .roll-result {
  text-align: center;
  font-size: 1.2em;
  margin: 5px 0;
}

.witch-iron-roll .critical-success {
  color: green;
  font-weight: bold;
}

.witch-iron-roll .success {
  color: blue;
}

.witch-iron-roll .failure {
  color: orange;
}

.witch-iron-roll .critical-failure {
  color: red;
  font-weight: bold;
}

/* Enhanced Monster Sheet Styles */
.witch-iron.sheet.monster .form-group {
  margin-bottom: 10px;
  display: flex;
  align-items: center;
}

.witch-iron.sheet.monster .form-group label {
  flex: 0 0 120px;
  font-weight: bold;
  color: var(--primary-color);
}

.witch-iron.sheet.monster .form-group select,
.witch-iron.sheet.monster .form-group input[type="text"],
.witch-iron.sheet.monster .form-group input[type="number"] {
  flex: 1;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  padding: 4px;
}

.witch-iron.sheet.monster .derived-stat {
  display: flex;
  justify-content: space-between;
  padding: 3px 5px;
  border-bottom: 1px dotted rgba(0, 0, 0, 0.1);
}

.witch-iron.sheet.monster .derived-stat:last-child {
  border-bottom: none;
}

.witch-iron.sheet.monster .derived-stat label {
  font-weight: bold;
  color: var(--primary-color);
}

.witch-iron.sheet.monster .derived-stat span {
  font-weight: bold;
  color: var(--accent-color);
}

.witch-iron.sheet.monster .items-header {
  display: flex;
  justify-content: space-between;
  padding: 5px 0;
  margin-bottom: 5px;
  font-weight: bold;
  color: var(--primary-color);
  border-bottom: 1px solid var(--border-color);
}

.witch-iron.sheet.monster .items-header .item-name {
  flex: 1;
}

.witch-iron.sheet.monster .items-header .item-controls {
  flex: 0 0 30px;
  text-align: right;
}

.witch-iron.sheet.monster .items-header .item-controls a {
  color: var(--primary-color);
}

.witch-iron.sheet.monster .items-header .item-controls a:hover {
  color: var(--accent-color);
}

.witch-iron.sheet.monster h2 {
  color: var(--color-primary);
  border-bottom: 1px solid var(--color-border);
  margin-top: 15px;
  margin-bottom: 10px;
  padding-bottom: 5px;
}

.witch-iron.sheet.monster h3 {
  color: var(--color-secondary);
  margin-top: 10px;
  margin-bottom: 5px;
}

.witch-iron.sheet.monster .derived-stats {
  background: rgba(194, 166, 132, 0.2);
  padding: 10px;
  border-radius: 5px;
  margin-top: 10px;
  border: 1px solid var(--color-tertiary);
}

.witch-iron.sheet.monster .mob-section {
  background: rgba(74, 32, 13, 0.1);
  padding: 10px;
  border-radius: 5px;
  margin-top: 15px;
  border: 1px solid var(--color-primary);
}

.witch-iron.sheet.monster .special-qualities {
  margin-top: 10px;
}

.witch-iron.sheet.monster .items-header {
  font-weight: bold;
  padding: 5px 0;
  border-bottom: 1px solid var(--color-border);
  display: flex;
}

.witch-iron.sheet.monster .item-name {
  flex: 1;
}

.witch-iron.sheet.monster .item-controls {
  flex: 0 0 24px;
  text-align: center;
}

.witch-iron.sheet.monster .qualities-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.witch-iron.sheet.monster .quality {
  padding: 5px 0;
  border-bottom: 1px solid var(--color-shadow);
  display: flex;
  align-items: center;
}

.witch-iron.sheet.monster .quality input {
  flex: 1;
  margin-right: 5px;
}

.witch-iron.sheet.monster .quality a {
  flex: 0 0 20px;
  text-align: center;
  color: var(--primary-color);
}

.witch-iron.sheet.monster .quality a:hover {
  color: var(--error-color);
}

.witch-iron.sheet.monster textarea {
  width: 100%;
  height: calc(100% - 40px);
  padding: 5px;
  background: rgba(255, 255, 255, 0.5);
  border: 1px solid var(--border-color);
  border-radius: 3px;
  font-family: inherit;
  resize: none;
}

.witch-iron.sheet.monster .monster-roll-actions {
  margin-top: 15px;
  text-align: center;
}

.witch-iron.sheet.monster .monster-roll {
  background: var(--color-primary);
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: background-color 0.2s;
}

.witch-iron.sheet.monster .monster-roll:hover {
  background: var(--color-secondary);
}

.witch-iron.sheet.monster .monster-roll i {
  margin-right: 5px;
}

/* Injury Sheet Styles */

/* Chat Cards */
.witch-iron.chat-card {
  font-family: "Roboto", sans-serif;
  border: 2px solid #782e22;
  border-radius: 5px;
  margin: 5px 0;
  background: #fff;
}

.witch-iron.chat-card .card-header {
  background: #782e22;
  color: #fff;
  padding: 5px 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.witch-iron.chat-card .card-header img {
  width: 36px;
  height: 36px;
  border: none;
  border-radius: 50%;
  object-fit: cover;
  margin-right: 8px;
}

.witch-iron.chat-card .card-header h3 {
  margin: 0;
  font-size: 1.2em;
  font-weight: bold;
  flex: 1;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.witch-iron.chat-card .card-content {
  padding: 10px;
}

.witch-iron.chat-card .roll-result {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
}

.witch-iron.chat-card .dice-roll {
  background: #f0f0f0;
  border-radius: 5px;
  padding: 10px;
  text-align: center;
}

.witch-iron.chat-card .dice-total {
  font-size: 2em;
  font-weight: bold;
  margin: 0;
}

.witch-iron.chat-card .test-details {
  display: grid;
  gap: 5px;
  width: 100%;
}

.witch-iron.chat-card .target,
.witch-iron.chat-card .outcome,
.witch-iron.chat-card .hits,
.witch-iron.chat-card .specialization {
  padding: 5px;
  border-radius: 3px;
  background: #f8f8f8;
}

/* Roll Outcomes */
.witch-iron.chat-card .roll-result.critical-success .outcome {
  color: #1a9850;
  font-weight: bold;
  background: #e6f5e6;
}

.witch-iron.chat-card .roll-result.success .outcome {
  color: #4d9221;
  background: #f0f7e6;
}

.witch-iron.chat-card .roll-result.failure .outcome {
  color: #c51b7d;
  background: #fce6ef;
}

.witch-iron.chat-card .roll-result.fumble .outcome {
  color: #de2d26;
  font-weight: bold;
  background: #fee6e6;
}

.witch-iron.chat-card .card-footer {
  padding: 5px;
  font-size: 0.9em;
  color: #666;
  border-top: 1px solid var(--color-border-lighter);
}

.witch-iron.chat-card .formula {
  font-family: monospace;
}

.witch-iron.chat-card .formula .label {
  font-weight: bold;
  margin-right: 5px;
}

/* Roll Mode Indicators */
.witch-iron.chat-card[data-visibility="gm"] {
  background: #f0f7ff;
}

.witch-iron.chat-card[data-visibility="self"] {
  background: #fff7f0;
}

.witch-iron.chat-card[data-visibility="blind"] {
  background: #f7f0ff;
}

/* ----------------------------------------- */
/*  Attribute Circles Layout                 */
/* ----------------------------------------- */

/* Main sheet layout - Remove conflicting sidebar styles, we're using the new ones */
.witch-iron.sheet.descendant {
  position: relative; /* Create positioning context */
}

/* Tab styling */
.witch-iron.sheet.descendant .sheet-tabs {
  margin-left: 0;
  border-bottom: 2px solid var(--border-color);
  padding-bottom: 5px;
  margin-bottom: 0; /* No margin as we want content to follow immediately */
}

/* Delete the conflicting sidebar styles below - we already have better ones above */
/* Fixed sidebar styles */

/* Content area - This is handled by our main styles */

/* Main content area - This is handled by our main styles */

/* Additional styles for popup editing */
.witch-iron.sheet.descendant .attribute-popup {
  animation: fadeIn 0.2s ease-out;
  background-color: var(--background-color);
  border: 2px solid var(--primary-color);
  border-radius: 8px;
  box-shadow: 0 0 15px var(--shadow-color);
  z-index: 100;
  padding: 12px;
}

.witch-iron.sheet.descendant .popup-attribute-input {
  width: 100%;
  text-align: center;
  font-size: 24px;
  margin-bottom: 8px;
  border: 1px solid var(--border-color);
  border-radius: 4px;
  padding: 8px;
  font-weight: bold;
  color: var(--primary-color);
}

.witch-iron.sheet.descendant .popup-attribute-label {
  font-size: 16px;
  font-weight: bold;
  color: var(--text-color);
  text-align: center;
  margin-top: 5px;
}

@keyframes fadeIn {
  from { opacity: 0; transform: scale(0.9); }
  to { opacity: 1; transform: scale(1); }
}

/* Remove duplicate active/hover styles that use old color variables */

.witch-iron.sheet.descendant .attribute-circle:hover {
  transform: scale(1.05);
  box-shadow: 0 0 8px var(--shadow-color);
  border-color: var(--accent-color);
  background: rgba(255, 255, 255, 0.5);
  z-index: 20;
}

.witch-iron.sheet.descendant .attribute-circle:active,
.witch-iron.sheet.descendant .attribute-circle.active {
  transform: scale(0.95);
  border-color: var(--accent-color);
  box-shadow: 0 0 12px var(--accent-color);
}

.witch-iron.sheet.descendant .attribute-circle:hover .attribute-label {
  color: var(--primary-color);
  font-weight: bold;
}

/* Skill specialization styles */
.witch-iron.sheet.descendant .skill-attribute-group {
  margin-bottom: 1.5em;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 1em;
}

.witch-iron.sheet.descendant .skill-attribute-group h3 {
  color: var(--primary-color);
  font-size: 1.2em;
  margin-bottom: 0.5em;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding-bottom: 0.3em;
}

.witch-iron.sheet.descendant .skill-specialization-button {
  flex: 0 0 30px;
  height: 24px;
  margin-left: 5px;
  padding: 0;
  background: #eee;
  border: 1px solid var(--color-border-light);
  border-radius: 3px;
}

.witch-iron.sheet.descendant .skill-specialization-button:hover {
  background: var(--color-border-lighter);
}

.witch-iron.sheet.descendant .skill-specializations {
  display: none;
  padding-left: 2em;
  margin-bottom: 0.5em;
}

.witch-iron.sheet.descendant .skill-specializations.visible {
  display: block;
}

.witch-iron.sheet.descendant .specialization-item {
  display: flex;
  align-items: center;
  padding: 3px 5px;
  margin: 2px 0;
}

.witch-iron.sheet.descendant .specialization-name {
  flex: 2;
  cursor: pointer;
  color: var(--color-border-dark);
}

.witch-iron.sheet.descendant .specialization-name:hover {
  text-decoration: underline;
}

.witch-iron.sheet.descendant .specialization-rating {
  flex: 0 0 30px;
  color: green;
  font-weight: bold;
}

/* Specialization popup */
.witch-iron.sheet.descendant .specialization-popup {
  position: absolute;
  background: white;
  border: 1px solid var(--color-border-lighter);
  border-radius: 5px;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  padding: 10px;
  z-index: 100;
  min-width: 250px;
}

.witch-iron.sheet.descendant .specialization-popup h3 {
  border-bottom: 1px solid var(--color-border-lighter);
  padding-bottom: 5px;
  margin-bottom: 10px;
  font-weight: bold;
  color: #742e1f;
}

.witch-iron.sheet.descendant .specialization-popup-list {
  margin-bottom: 10px;
  max-height: 200px;
  overflow-y: auto;
}

.witch-iron.sheet.descendant .specialization-popup-item {
  display: flex;
  align-items: center;
  padding: 5px;
  border-bottom: 1px solid #f0f0f0;
}

.witch-iron.sheet.descendant .specialization-popup-name {
  flex: 2;
}

.witch-iron.sheet.descendant .specialization-popup-rating {
  flex: 1;
  text-align: center;
  color: green;
  font-weight: bold;
}

.witch-iron.sheet.descendant .specialization-popup-controls {
  flex: 1;
  text-align: right;
}

.witch-iron.sheet.descendant .specialization-popup-controls a {
  color: #742e1f;
  margin-left: 5px;
}

.witch-iron.sheet.descendant .specialization-popup-controls a:hover {
  color: #8c3826;
}

.witch-iron.sheet.descendant .specialization-popup-new {
  display: flex;
  align-items: center;
  padding-top: 10px;
  border-top: 1px solid var(--color-border-lighter);
}

.witch-iron.sheet.descendant .specialization-popup-new input[type="text"] {
  flex: 2;
  margin-right: 5px;
}

.witch-iron.sheet.descendant .specialization-popup-new input[type="number"] {
  flex: 1;
  margin-right: 5px;
}

.witch-iron.sheet.descendant .specialization-popup-new button {
  flex: 0 0 30px;
  height: 24px;
  padding: 0;
  background: #742e1f;
  color: white;
  border: 1px solid #521e10;
  border-radius: 3px;
}

.witch-iron.sheet.descendant .specialization-popup-new button:hover {
  background: #8c3826;
}

/* Position skills to align with attribute circles */
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="muscle"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="robustness"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="agility"] {
  margin-top: 0px;
}

.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="quickness"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="finesse"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="intellect"] {
  margin-top: 0px;
}

.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="willpower"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="personality"],
.witch-iron.sheet.descendant .skill-attribute-group[data-attribute="luck"] {
  margin-top: 0px;
}

/* Ensure skills tab has scrolling for potentially long content */
.witch-iron.sheet.descendant .tab.skills {
  overflow-y: auto;
  max-height: 100%;
}

/* Skills styling */
.witch-iron.sheet.descendant .skill-name {
  cursor: pointer;
  color: var(--color-text-hyperlink, #4b6dc5);
  position: relative;
}

.witch-iron.sheet.descendant .skill-name:hover {
  text-decoration: underline;
}

.witch-iron.sheet.descendant .skill-name::after {
  display: none;
}

.witch-iron.sheet.descendant .skill-specializations {
  display: none;
  margin-left: 20px;
  padding: 5px 0;
  border-left: 2px solid rgba(0,0,0,0.1);
  padding-left: 10px;
}

.witch-iron.sheet.descendant .skill-specializations.visible {
  display: block;
}

.witch-iron.sheet.descendant .skill-attribute-group {
  margin-bottom: 20px;
  border: 1px solid #d8d8d8;
  border-radius: 5px;
  padding: 10px;
  background: rgba(0,0,0,0.02);
}

.witch-iron.sheet.descendant .skill-attribute-group h3 {
  border-bottom: 1px solid #d8d8d8;
  margin-bottom: 10px;
  padding-bottom: 5px;
  font-weight: bold;
  color: #742e1f;
}

.witch-iron.sheet.descendant .reset-skills-button {
  background: #742e1f;
  color: white;
  padding: 5px 10px;
  border: 1px solid #521e10;
  border-radius: 3px;
  cursor: pointer;
}

.witch-iron.sheet.descendant .reset-skills-button:hover {
  background: #8c3826;
}

.witch-iron.sheet.descendant .debug-info {
  max-height: 300px;
  overflow-y: auto;
}

/* Skills Styles */
.skills-container {
  margin-top: 0px;
}

.skill-attribute-group {
  margin-bottom: 15px;
}

.skill-attribute-group h3 {
  border-bottom: 1px solid var(--color-border-light);
  margin-bottom: 5px;
  padding-bottom: 3px;
}

.skill-column-headers {
  display: flex;
  align-items: center;
  padding: 0;
  margin-bottom: 5px;
  font-weight: bold;
  color: var(--color-text);
  font-size: 0.9em;
}

.skill-column-headers .skill-name-header {
  flex: 0 0 75px;
  min-width: 75px;
  padding-right: 0;
}

.skill-column-headers .skill-value-header {
  flex: 0 0 80px;
  text-align: center;
}

.skill-column-headers .skill-modifier-header {
  flex: 0 0 35px;
  text-align: center;
}

.skill-column-headers .specializations-header {
  flex: 2;
  text-align: center;
}

.skill-item {
  display: flex;
  padding: 5px 0;
  align-items: center;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

.skill-name {
  flex: 0 0 120px;
  min-width: 50px;
  max-width: 80px;
  font-weight: bold;
  cursor: pointer;
  color: var(--color-text-hyperlink);
  padding-right: 0;
}

.skill-name:hover {
  text-decoration: underline;
}

/* Remove the down arrow from skill names */
.skill-name::after {
  display: none;
}

.skill-item input[type="number"] {
  flex: 0 0 80px;
  width: 80px;
  text-align: center;
  margin: 0;
}

.skill-specialization-button {
  flex: 0 0 40px;
  margin-left: 0;
  width: 30px;
  height: 24px;
  padding: 0;
  line-height: 1;
}

.specializations-inline {
  flex: 2;
  display: flex;
  flex-wrap: wrap;
  margin-left: 5px;
  gap: 5px;
}

.specialization-tag {
  display: inline-block;
  background-color: rgba(0, 0, 0, 0.05);
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 0.9em;
  cursor: pointer;
  white-space: nowrap;
}

.specialization-tag:hover {
  background-color: rgba(0, 0, 0, 0.1);
}

/* ----------------------------------------- */
/*  Quarrel System Styles                     */
/* ----------------------------------------- */

.witch-iron.quarrel-result {
  border: 2px solid var(--primary-color);
  border-radius: 5px;
  margin: 5px 0;
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 100%);
}

.witch-iron.quarrel-result .card-header {
  background: var(--primary-color);
  color: white;
  padding: 5px 10px;
  text-align: center;
}

.witch-iron.quarrel-result .card-header h3 {
  margin: 0;
  font-family: 'Gentium Book', serif;
}

.witch-iron.quarrel-result .card-content {
  padding: 10px;
}

.witch-iron.quarrel-result .quarrel-combatants {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.witch-iron.quarrel-result .initiator,
.witch-iron.quarrel-result .responder {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  padding: 8px 5px;
  border-radius: 5px;
}

.witch-iron.quarrel-result .initiator.Victory,
.witch-iron.quarrel-result .responder.Victory {
  background-color: rgba(0, 100, 0, 0.1);
}

.witch-iron.quarrel-result .initiator.Failure,
.witch-iron.quarrel-result .responder.Failure {
  background-color: rgba(139, 0, 0, 0.1);
}

.witch-iron.quarrel-result .initiator.victory-at-cost,
.witch-iron.quarrel-result .responder.victory-at-cost {
  background-color: rgba(255, 165, 0, 0.1);
}

.witch-iron.quarrel-result .token-container {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid var(--border-color);
  margin-bottom: 5px;
}

.witch-iron.quarrel-result .token-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.witch-iron.quarrel-result .versus {
  font-weight: bold;
  font-size: 1.3em;
  padding: 0 15px;
  color: var(--accent-color);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.witch-iron.quarrel-result .net-hits {
  font-size: 0.9em;
  margin-top: 5px;
}

.witch-iron.quarrel-result .net-hits.positive {
  color: var(--success-color);
  font-weight: bold;
}

.witch-iron.quarrel-result .net-hits.negative {
  color: var(--error-color);
  font-weight: bold;
}

.witch-iron.quarrel-result .name {
  font-weight: bold;
  margin-bottom: 3px;
  font-size: 1.1em;
  color: var(--primary-color);
  text-align: center;
}

.witch-iron.quarrel-result .hits {
  font-style: italic;
  font-size: 0.9em;
  margin-bottom: 5px;
}

.witch-iron.quarrel-result .outcome {
  font-size: 1em;
  font-weight: bold;
  padding: 3px 8px;
  border-radius: 3px;
  background: rgba(0, 0, 0, 0.1);
}

.witch-iron.quarrel-result .outcome.Victory {
  color: var(--success-color);
  background-color: rgba(0, 100, 0, 0.1);
}

.witch-iron.quarrel-result .outcome.victory-at-cost {
  color: darkorange;
  background-color: rgba(255, 165, 0, 0.1);
}

.witch-iron.quarrel-result .outcome.Failure {
  color: var(--error-color);
  background-color: rgba(139, 0, 0, 0.1);
}

/* Card Buttons for Quarrel */
.witch-iron .card-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--border-color);
}

.witch-iron .card-buttons button {
  background: var(--accent-color);
  color: white;
  border: 1px solid var(--primary-color);
  border-radius: 3px;
  padding: 5px 10px;
  cursor: pointer;
  font-size: 0.9em;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;
}

.witch-iron .card-buttons button:hover {
  background: var(--primary-color);
}

.witch-iron .card-buttons button i {
  font-size: 0.9em;
}

/* Quarrel initiated card styles */
.witch-iron.chat-card.quarrel-initiated {
  display: flex;
  flex-direction: column;
  padding: 0;
  border: 3px solid var(--primary-color);
  border-radius: 5px;
  margin: 8px 0;
  font-family: 'Gentium Book', serif;
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 100%);
  box-shadow: 0 0 8px var(--shadow-color);
  overflow: hidden;
  max-width: 100%;
}

.witch-iron.chat-card.quarrel-initiated .quarrel-header {
  background: var(--primary-color);
  color: white;
  padding: 8px 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.witch-iron.chat-card.quarrel-initiated .quarrel-header i {
  font-size: 1.2em;
}

.witch-iron.chat-card.quarrel-initiated .quarrel-title {
  font-weight: bold;
  font-size: 1.2em;
}

.witch-iron.chat-card.quarrel-initiated .quarrel-content {
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 12px;
}

.witch-iron.chat-card.quarrel-initiated .initiator-name,
.witch-iron.chat-card.quarrel-initiated .target-name {
  font-weight: bold;
  color: var(--primary-color);
  font-size: 1.2em;
}

.witch-iron.chat-card.quarrel-initiated .vs-separator {
  margin: 0 15px;
  font-size: 1.3em;
  font-weight: bold;
  color: var(--accent-color);
}

/* Quarrel result styles */
.witch-iron.chat-card.quarrel-result {
  border: 3px solid var(--primary-color);
  border-radius: 5px;
  margin: 8px 0;
  font-family: 'Gentium Book', serif;
  background: linear-gradient(180deg, var(--tertiary-color) 0%, var(--background-color) 100%);
  box-shadow: 0 0 8px var(--shadow-color);
  overflow: hidden;
  max-width: 100%;
}

.witch-iron.chat-card.quarrel-result .quarrel-header {
  background: var(--primary-color);
  color: white;
  padding: 8px 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 10px;
}

.witch-iron.chat-card.quarrel-result .quarrel-header i {
  font-size: 1.2em;
}

.witch-iron.chat-card.quarrel-result .quarrel-header h3 {
  margin: 0;
  font-size: 1.2em;
  font-weight: bold;
}

.witch-iron.chat-card.quarrel-result .card-content {
  padding: 12px;
}

.witch-iron.chat-card.quarrel-result .quarrel-combatants {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.witch-iron.chat-card.quarrel-result .initiator,
.witch-iron.chat-card.quarrel-result .responder {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex: 1;
  padding: 8px 5px;
  border-radius: 5px;
}

.witch-iron.chat-card.quarrel-result .initiator.Victory,
.witch-iron.chat-card.quarrel-result .responder.Victory {
  background-color: rgba(0, 100, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .initiator.Failure,
.witch-iron.chat-card.quarrel-result .responder.Failure {
  background-color: rgba(139, 0, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .initiator.victory-at-cost,
.witch-iron.chat-card.quarrel-result .responder.victory-at-cost {
  background-color: rgba(255, 165, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .token-container {
  width: 50px;
  height: 50px;
  border-radius: 50%;
  overflow: hidden;
  border: 2px solid var(--border-color);
  margin-bottom: 5px;
}

.witch-iron.chat-card.quarrel-result .token-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.witch-iron.chat-card.quarrel-result .versus {
  font-weight: bold;
  font-size: 1.3em;
  padding: 0 15px;
  color: var(--accent-color);
  display: flex;
  flex-direction: column;
  align-items: center;
}

.witch-iron.chat-card.quarrel-result .net-hits {
  font-size: 0.9em;
  margin-top: 5px;
}

.witch-iron.chat-card.quarrel-result .net-hits.positive {
  color: var(--success-color);
  font-weight: bold;
}

.witch-iron.chat-card.quarrel-result .net-hits.negative {
  color: var(--error-color);
  font-weight: bold;
}

.witch-iron.chat-card.quarrel-result .name {
  font-weight: bold;
  margin-bottom: 3px;
  font-size: 1.1em;
  color: var(--primary-color);
  text-align: center;
}

.witch-iron.chat-card.quarrel-result .hits {
  font-style: italic;
  font-size: 0.9em;
  margin-bottom: 5px;
}

.witch-iron.chat-card.quarrel-result .outcome {
  font-size: 1em;
  font-weight: bold;
  padding: 3px 8px;
  border-radius: 3px;
  background: rgba(0, 0, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .outcome.Victory {
  color: var(--success-color);
  background-color: rgba(0, 100, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .outcome.victory-at-cost {
  color: darkorange;
  background-color: rgba(255, 165, 0, 0.1);
}

.witch-iron.chat-card.quarrel-result .outcome.Failure {
  color: var(--error-color);
  background-color: rgba(139, 0, 0, 0.1);
}

/* Card Buttons for Quarrel */
.witch-iron .card-buttons {
  display: flex;
  justify-content: center;
  gap: 10px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--border-color);
}

.witch-iron .card-buttons button {
  background: var(--accent-color);
  color: white;
  border: 1px solid var(--primary-color);
  border-radius: 3px;
  padding: 5px 10px;
  cursor: pointer;
  font-size: 0.9em;
  display: flex;
  align-items: center;
  gap: 5px;
  transition: background-color 0.2s;
}

.witch-iron .card-buttons button:hover {
  background: var(--primary-color);
}

.witch-iron .card-buttons button i {
  font-size: 0.9em;
}

/* Add explicit tooltip styling for quarrel elements */
.witch-iron.chat-card.quarrel-result .initiator,
.witch-iron.chat-card.quarrel-result .token-container,
.witch-iron.chat-card.quarrel-result .token-image,
.witch-iron.chat-card.quarrel-result .responder {
  position: relative;
}

.witch-iron.chat-card.quarrel-result .initiator:hover::after,
.witch-iron.chat-card.quarrel-result .token-container:hover::after,
.witch-iron.chat-card.quarrel-result .token-image:hover::after,
.witch-iron.chat-card.quarrel-result .responder:hover::after {
  content: none;
}

.witch-iron.chat-card.quarrel-result .token-name {
  display: block;
  font-weight: bold;
  margin-bottom: 8px;
  font-size: 1.25em;
  color: var(--primary-color);
  text-align: center;
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  margin-top: 5px;
  text-shadow: 0 1px 1px white;
}

.quarrel-card .token-name {
  text-align: center;
  font-weight: bold;
  margin-bottom: 5px;
  font-size: 1.1em;
  width: 100%;
}

.quarrel-card .token-container {
  display: flex;
  justify-content: center;
  position: relative;
}

.quarrel-card .token-image {
  width: 50px;
  height: 50px;
  border: none;
}

.quarrel-card .quarrel-combatants {
  display: flex;
  justify-content: space-around;
  align-items: flex-start;
  margin: 10px 0;
}

.quarrel-card .initiator, .quarrel-card .responder {
  display: flex;
  flex-direction: column;
  align-items: center;
  width: 40%;
  padding: 5px;
  border-radius: 5px;
}

.quarrel-card .initiator.Victory, .quarrel-card .responder.Victory {
  background-color: rgba(0, 128, 0, 0.2);
}

.quarrel-card .initiator.Defeat, .quarrel-card .responder.Defeat {
  background-color: rgba(255, 0, 0, 0.2);
}

.quarrel-card .flip-hits-btn {
  cursor: pointer;
  font-size: 1em;
  color: var(--primary-color);
  background-color: rgba(255, 255, 255, 0.5);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 10px;
  transition: all 0.2s ease;
}

.quarrel-card .flip-hits-btn:hover {
  background-color: var(--tertiary-color);
  transform: scale(1.1);
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
}

.quarrel-card .net-hits {
  margin-top: 8px;
  padding: 4px 8px;
  border-radius: 4px;
  font-weight: bold;
  text-align: center;
  background-color: rgba(255, 255, 255, 0.5);
}

.quarrel-card .net-hits.positive {
  color: var(--success-color);
  border: 1px solid rgba(0, 100, 0, 0.3);
}

.quarrel-card .net-hits.negative {
  color: var(--error-color);
  border: 1px solid rgba(139, 0, 0, 0.3);
}

.quarrel-card .hidden-net-hits {
  display: none;
}

.witch-iron.chat-card.quarrel-result .flip-hits-btn {
  cursor: pointer;
  font-size: 1em;
  color: var(--primary-color);
  background-color: rgba(255, 255, 255, 0.5);
  border-radius: 50%;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-top: 5px;
  transition: all 0.2s ease;
}

.witch-iron.chat-card.quarrel-result .flip-hits-btn:hover {
  background-color: var(--tertiary-color);
  transform: scale(1.1);
  box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
} 

.quarrel-card .flip-hits-btn.rotating,
.witch-iron.chat-card.quarrel-result .flip-hits-btn.rotating {
  animation: flip-rotate 0.5s ease;
}

@keyframes flip-rotate {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* Custom attribute circles */
.witch-iron.sheet.monster .custom-circle {
  position: relative;
}

.witch-iron.sheet.monster .custom-circle[data-attribute="custom1"],
.witch-iron.sheet.monster .custom-circle[data-attribute="custom2"] {
  /* Styles are now handled by the shared selector above */
}

/* Style the monster sheet specific elements */
.witch-iron.sheet.monster .stats-content,
.witch-iron.sheet.monster .traits-content,
.witch-iron.sheet.monster .notes-content {
  padding-right: 5px;
}

/* Make sure checkbox sizing is appropriate */
.witch-iron.sheet.monster .form-group input[type="checkbox"] {
  flex: 0 0 20px;
  margin-right: 5px;
  height: 20px;
  width: 20px;
}

/* Make attribute circles' vertical spacing match descendant sheet */
.witch-iron.sheet.monster .attribute-circles {
  gap: 15px;
  margin-bottom: 5px;
}

/* Ensure the main form takes full height */
.witch-iron.sheet.monster form {
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* Fix margins for sheet-body */
.witch-iron.sheet.monster .sheet-body {
  margin: 0 0 0 5px;
  padding-bottom: 10px;
}

/* Make sure tab contents use full height */
.witch-iron.sheet.monster .tab {
  height: 100%;
  overflow-y: auto;
}

/* Ensure text fields expand properly */
.witch-iron.sheet.monster textarea {
  height: calc(100% - 40px);
  min-height: 300px;
}

/* Monster Sheet - Rearranged Sections */
.witch-iron.sheet.monster .notes-content .derived-stats {
  background: rgba(0, 0, 0, 0.05);
  border-radius: 5px;
  padding: 10px;
  margin-bottom: 20px;
}

.witch-iron.sheet.monster .stats-content .mob-section {
  margin-top: 20px;
  padding-top: 10px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.witch-iron.sheet.monster .stats-content .qualities-list {
  margin-bottom: 20px;
}

/* Monster Stats Grid Layout */
.witch-iron.sheet.monster .stats-content .grid-2col {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 10px;
}

.witch-iron.sheet.monster .stats-content .grid-2col .form-group {
  margin: 0;
}

.witch-iron.sheet.monster .stats-content .form-group label {
  display: block;
  font-weight: bold;
  margin-bottom: 3px;
}

.witch-iron.sheet.monster .stats-content .form-group select {
  width: 100%;
  height: 28px;
}

/* Combat Result Styling */
.witch-iron.chat-card .combat-result {
    margin-top: 10px;
    padding: 10px;
    background: rgba(139, 0, 0, 0.05);
    border: 1px solid var(--border-color);
    border-radius: 5px;
}

.witch-iron.chat-card .combat-result h3 {
    color: var(--primary-color);
    font-size: 1.2em;
    margin: 0 0 10px 0;
    padding-bottom: 5px;
    border-bottom: 1px solid var(--border-color);
}

.witch-iron.chat-card .injury-details {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.witch-iron.chat-card .injury-attacker {
    font-weight: bold;
    color: var(--primary-color);
}

.witch-iron.chat-card .injury-calculation {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    padding: 5px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 3px;
}

.witch-iron.chat-card .injury-calculation span {
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 0.9em;
}

.witch-iron.chat-card .weapon-dmg {
    background: rgba(139, 0, 0, 0.1);
}

.witch-iron.chat-card .net-hits {
    background: rgba(0, 100, 0, 0.1);
}

.witch-iron.chat-card .soak {
    background: rgba(0, 0, 139, 0.1);
}

.witch-iron.chat-card .net-damage {
    font-weight: bold;
    background: rgba(139, 69, 19, 0.1);
}

.witch-iron.chat-card .hit-location {
    font-weight: bold;
    background: rgba(128, 0, 128, 0.1);
}

.witch-iron.chat-card .injury-table {
    margin-top: 5px;
    padding: 8px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
}

.witch-iron.chat-card .injury-table h4 {
    margin: 0 0 5px 0;
    color: var(--primary-color);
    font-size: 1em;
}

.witch-iron.chat-card .injury-result {
    padding: 5px;
    background: rgba(255, 255, 255, 0.5);
    border-radius: 3px;
    font-weight: bold;
    color: var(--primary-color);
}

.witch-iron.chat-card .injury-note {
    margin-top: 5px;
    font-style: italic;
    font-size: 0.9em;
    color: #666;
}

/* Combat Results Styling */
.combat-result {
  background: rgba(30, 30, 30, 0.9);
  border: 1px solid var(--color-border-dark);
  border-radius: 5px;
  padding: 10px;
  margin: 10px 0;
  color: #eee;
  font-family: "Times New Roman", Times, serif;
}

.combat-header {
  text-align: center;
  border-bottom: 1px solid #666;
  padding-bottom: 8px;
  margin-bottom: 12px;
  font-size: 1.5em;
  text-transform: uppercase;
  letter-spacing: 2px;
  color: #e6c9a3;
}

.combat-details {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 5px;
  margin-bottom: 12px;
}

.detail-row {
  display: flex;
  align-items: center;
  padding: 2px 0;
}

.label {
  font-weight: bold;
  width: 100px;
  color: #a89078;
}

.value {
  flex: 1;
}

.injury-header {
  text-align: center;
  color: #e6c9a3;
  font-size: 1.2em;
  margin: 10px 0;
  border-bottom: 1px solid #666;
  padding-bottom: 5px;
}

.injury-result {
  background: rgba(50, 30, 30, 0.6);
  border-radius: 4px;
  padding: 10px;
  margin-top: 5px;
  font-style: italic;
}

.injury-result p {
  margin: 5px 0;
  line-height: 1.4;
}

.injury-result p:first-child {
  font-weight: bold;
  color: var(--color-accent);
}

@media (max-width: 600px) {
  .combat-details {
    grid-template-columns: 1fr;
  }
}

/* Toggle buttons for combat results */
.combat-toggle-button,
.injury-toggle-button {
  text-align: center;
  margin: 8px 0;
}

.toggle-combat-result,
.toggle-injury-result {
  background: rgba(30, 30, 30, 0.8);
  border: 1px solid #666;
  color: #e6c9a3;
  padding: 5px 10px;
  border-radius: 4px;
  cursor: pointer;
  font-family: "Times New Roman", Times, serif;
  font-weight: bold;
  width: 100%;
  transition: background-color 0.2s;
}

.toggle-combat-result:hover,
.toggle-injury-result:hover {
  background: rgba(40, 40, 40, 0.9);
  text-shadow: 0 0 5px #e6c9a3;
}

.toggle-combat-result i,
.toggle-injury-result i {
  margin-right: 5px;
  transition: transform 0.2s;
}

.toggle-combat-result i.fa-chevron-up,
.toggle-injury-result i.fa-chevron-up {
  transform: rotate(180deg);
}

.combat-result-container {
  margin-top: 10px;
  border-top: 1px solid var(--color-border-dark);
  padding-top: 8px;
}

.injury-result-container {
  margin-top: 5px;
}

.combat-badge {
  display: inline-block;
  font-size: 0.7em;
  background-color: var(--color-accent);
  color: var(--color-surface-light);
  padding: 2px 6px;
  border-radius: 4px;
  margin-left: 8px;
  vertical-align: middle;
  font-weight: normal;
  letter-spacing: 1px;
  text-transform: uppercase;
  font-family: "Times New Roman", Times, serif;
}

/* Combat check styling */
.combat-check-section {
  margin: 10px 0;
  padding: 8px;
  background: rgba(123, 45, 38, 0.1);
  border: 1px solid var(--color-accent);
  border-radius: 4px;
  text-align: center;
}

.combat-check-label {
  font-weight: bold;
  font-size: 1.1em;
  margin-left: 5px;
  color: var(--color-accent);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.checkbox input[type="checkbox"] {
  transform: scale(1.2);
  margin-right: 5px;
}

.toggle-combat-result.disabled,
.toggle-injury-result.disabled {
  opacity: 0.6;
  cursor: not-allowed;
  background: rgba(60, 60, 60, 0.6);
  color: var(--color-text-muted);
}

/* Monster Actions Section */
.monster-actions-section {
  margin: 15px 0;
  text-align: center;
}

.monster-actions-section h2 {
  font-size: 1.2em;
  margin-bottom: 10px;
  text-align: center;
  color: var(--color-accent);
  border-bottom: 1px solid var(--color-accent);
  padding-bottom: 5px;
}

.monster-actions {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.monster-action {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 10px;
  border-radius: 5px;
  font-weight: bold;
  color: var(--color-surface-light);
  cursor: pointer;
  transition: all 0.2s ease;
  height: 50px;
  border: none;
  text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
}

.monster-action i {
  font-size: 1.2em;
  margin-bottom: 5px;
}

.monster-action.melee-attack {
  background: linear-gradient(to bottom, var(--color-accent), #5a1e1a);
  box-shadow: 0 3px 0 #4e1b17;
}

.monster-action.melee-attack:hover {
  background: linear-gradient(to bottom, #8c332c, #6a241f);
  transform: translateY(-2px);
  box-shadow: 0 5px 0 #4e1b17;
}

.monster-action.melee-attack:active {
  transform: translateY(1px);
  box-shadow: 0 2px 0 #4e1b17;
}

.monster-action.specialized-roll {
  background: linear-gradient(to bottom, #3d5a80, #293f59);
  box-shadow: 0 3px 0 #233549;
}

.monster-action.specialized-roll:hover {
  background: linear-gradient(to bottom, #496d9b, #324c6b);
  transform: translateY(-2px);
  box-shadow: 0 5px 0 #233549;
}

.monster-action.specialized-roll:active {
  transform: translateY(1px);
  box-shadow: 0 2px 0 #233549;
}

/* Injury Actions Styling */
.injury-actions {
  margin-top: 10px;
  text-align: center;
  padding: 5px 0;
}

.create-injury {
  display: inline-block;
  background: linear-gradient(to bottom, var(--color-accent), #5a1e1a);
  color: #fff;
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  font-size: 0.9em;
  cursor: pointer;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  transition: all 0.2s ease;
}

.create-injury:hover {
  background: linear-gradient(to bottom, #8c332c, #6a241f);
  transform: translateY(-2px);
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.4);
}

.create-injury:active {
  transform: translateY(1px);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

.create-injury i {
  margin-right: 5px;
}

@media (max-width: 600px) {
  .create-injury {
    width: 100%;
    margin-bottom: 10px;
  }
}

/* Injuries Tab */
.injuries-list {
  margin: 10px 0;
  padding: 0 10px;
}

.injuries-list h2 {
  border-bottom: 2px solid #782e22;
  color: #782e22;
  font-size: 1.6em;
  margin-bottom: 10px;
  padding-bottom: 5px;
}

.injuries-list .items-header {
  border-bottom: 1px solid #782e22;
  font-weight: bold;
  margin-bottom: 5px;
  padding: 5px 0;
}

.injuries-list .items-header span {
  padding: 0 5px;
}

.injuries-list .items-list {
  list-style: none;
  margin: 0;
  padding: 0;
}

.injuries-list .item {
  align-items: center;
  border-bottom: 1px solid var(--color-border-lighter);
  display: flex;
  padding: 5px 0;
}

.injuries-list .item:hover {
  background-color: rgba(120, 46, 34, 0.1);
}

.injuries-list .injury-name {
  flex: 2;
  padding: 0 5px;
}

.injuries-list .injury-severity {
  flex: 1;
  padding: 0 5px;
}

.injuries-list .injury-effect {
  flex: 3;
  padding: 0 5px;
}

.injuries-list .item-controls {
  display: flex;
  flex: 0 0 60px;
  justify-content: flex-end;
}

.injuries-list .item-control {
  color: #782e22;
  margin: 0 3px;
}

.injuries-list .item-control:hover {
  color: #9e3b29;
  text-shadow: 0 0 5px #f0a890;
}

.injuries-list .item-create {
  margin-top: 10px;
  text-align: center;
}

.injuries-list .create-injury {
  background: #782e22;
  border: 1px solid #5a231a;
  border-radius: 3px;
  color: white;
  padding: 5px 10px;
}

.injuries-list .create-injury:hover {
  background: #9e3b29;
  box-shadow: 0 0 5px #f0a890;
}

/* Injury severity colors */
.injuries-list .severity-minor {
  color: #3a7828;
}

.injuries-list .severity-moderate {
  color: #78662e;
}

.injuries-list .severity-severe {
  color: #782e22;
}

/* Apply to all actor sheets */
.witch-iron.sheet.monster .injuries-list,
.witch-iron.sheet.descendant .injuries-list {
  height: 100%;
  overflow-y: auto;
}

/* Battle Wear Controls */
.witch-iron.sheet.monster .battle-wear-controls {
  margin-bottom: 10px;
}

.witch-iron.sheet.monster .battle-wear-control {
  display: flex;
  align-items: center;
  margin-top: 5px;
}

.witch-iron.sheet.monster .battle-wear-value {
  display: inline-block;
  font-size: 1.2em;
  font-weight: bold;
  width: 40px;
  text-align: center;
  margin: 0 5px;
  padding: 3px 5px;
  border: 1px solid var(--color-text-dark);
  background-color: #fff;
  border-radius: 3px;
  color: #000;
  min-height: 25px;
  line-height: 25px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}

.witch-iron.sheet.monster .battle-wear-minus,
.witch-iron.sheet.monster .battle-wear-plus,
.witch-iron.sheet.monster .battle-wear-reset {
  width: 32px;
  height: 32px;
  padding: 0;
  line-height: 1;
  background-color: var(--tertiary-color);
  border: 1px solid var(--border-color);
  border-radius: 4px;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.witch-iron.sheet.monster .battle-wear-reset {
  margin-left: 8px;
  background-color: var(--secondary-color);
  color: #fff;
}

.witch-iron.sheet.monster .battle-wear-minus:hover,
.witch-iron.sheet.monster .battle-wear-plus:hover {
  background-color: var(--highlight-color);
  color: #fff;
}

.witch-iron.sheet.monster .battle-wear-reset:hover {
  background-color: var(--accent-color);
}

.witch-iron.sheet.monster .battle-wear-minus:disabled,
.witch-iron.sheet.monster .battle-wear-plus:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  background-color: var(--color-border-light);
}

/* Dynamic potential injury display */
.potential-injury {
  margin: 10px 0;
  padding: 8px;
  background-color: rgba(246, 240, 228, 0.4);
  border: 1px solid #c3b6a0;
  border-radius: 4px;
  font-size: 0.95em;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.potential-injury-heading {
  font-weight: bold;
  font-size: 1em;
  margin-bottom: 5px;
  color: #602010;
  text-align: center;
  border-bottom: 1px solid #d0c0b0;
  padding-bottom: 4px;
}

.damage-range {
  display: flex;
  flex-direction: column;
  gap: 4px;
  margin-top: 5px;
}

.range-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.range-label {
  font-weight: bold;
  color: #555;
}

.range-value {
  color: #602010;
}

.potential-result {
  text-align: center;
  margin-top: 5px;
  font-weight: bold;
}

.new-damage {
  display: block;
  font-size: 1.1em;
  color: #9a2617;
  margin-bottom: 3px;
}

.new-severity {
  display: block;
  color: #602010;
}

.deflected {
  color: #007a00;
  font-size: 1.1em;
  font-weight: bold;
}

/* Battle wear calculations section in combat details */
.battle-wear-calculations {
  margin-top: 10px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  padding-top: 8px;
}

.battle-wear-section {
  background-color: rgba(240, 235, 225, 0.4);
  padding: 4px 8px;
  border-radius: 3px;
  margin-bottom: 5px;
}

.battle-wear-section h4 {
  margin: 0;
  font-size: 1em;
  color: #602010;
}

.battle-wear-formula {
  font-size: 0.9em;
  font-family: monospace;
  background-color: rgba(0, 0, 0, 0.05);
  padding: 4px 8px;
  border-radius: 3px;
  margin-bottom: 5px;
}

.damage-range, .damage-exact {
  margin-top: 5px;
  font-size: 0.9em;
  padding: 0 8px;
}

.range-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2px;
  padding: 2px 0;
}

.range-label {
  font-weight: bold;
  color: #555;
}

.range-value {
  color: #602010;
}

/* -------------------------------------------------------------------------- */
/* Injury Sheet Custom Styling */
/* -------------------------------------------------------------------------- */
.witch-iron.sheet.item.injury .sheet-header {
  padding: 4px 8px;
  background-color: var(--sheet-header-background, #f5f5f5);
  border-bottom: 1px solid var(--border-color);
}
.witch-iron.sheet.item.injury .sheet-header img {
  height: 32px;
  width: 32px;
}
.witch-iron.sheet.item.injury .header-fields h1 input {
  font-size: 1.2em;
  height: 28px;
  margin: 0;
}
.witch-iron.sheet.item.injury .sheet-section h3 {
  font-size: 1.1em;
  margin: 8px 0 4px;
  padding-bottom: 2px;
  border-bottom: 1px solid var(--border-color);
}
.witch-iron.sheet.item.injury .form-group label {
  font-size: 0.9em;
  font-weight: 600;
  margin-bottom: 4px;
}
.witch-iron.sheet.item.injury .form-group select,
.witch-iron.sheet.item.injury .form-group input,
.witch-iron.sheet.item.injury .form-group textarea {
  font-size: 0.9em;
}

/* Adjust header height for item sheets to snugly fit content */
.witch-iron.sheet.item .sheet-header {
  flex: 0 0 auto;
  height: auto;
  padding: 4px 8px;
}
/* -------------------------------------------------------------------------- */
/* Modifier Dialog Styles */
/* -------------------------------------------------------------------------- */
.modifier-dialog .form-group {
  display: flex;
  align-items: center;
  margin-bottom: 6px;
}
.modifier-dialog label {
  flex: 1;
  font-weight: bold;
}
.modifier-dialog input[type="number"],
.modifier-dialog select {
  width: 60px;
  margin-left: 4px;
}
.modifier-dialog .modifier-row {
  cursor: pointer;
  padding: 2px 4px;
  border-radius: 3px;
  transition: background 0.2s;
}
.modifier-dialog .modifier-row:hover {
  background: var(--color-highlight);
}
.modifier-dialog .modifier-row.selected {
  background: var(--color-accent);
  color: var(--color-background);
}
.modifier-dialog .modifier-row.selected input[type="number"] {
  color: var(--color-background);
}

/* Active Effects list within the modifier dialog */
.modifier-dialog .effects-list {
  max-height: 120px;
  overflow-y: auto;
  border: 1px solid var(--color-border-light-primary);
  padding: 4px;
  margin-bottom: 6px;
}

.modifier-dialog .effect-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
